---
title: Agricultural Production Statistics in New Zealand
date: 2026-02-17
published: 2026-02-17T17:53:52Z
week: 7
charts:
  nz-livestock:
    type: timeseries
    file: 2026-02-17/nz_livestock.csv
    title: The Rise and Fall of the Sheep
    subtitle: Population of New Zealand livestock from 1935 to 2024
    y:
      columns:
        sheep: Sheep
        cattle: Cattle
        pigs: Pigs
        poultry: Poultry
      max: 80000000
      title: Population
      format:
        compact: true
    icons:
      sheep: fa-solid fa-sheep
      cattle: fa-solid fa-cow
      pigs: fa-solid fa-pig
      poultry: fa-solid fa-turkey
    alt: Time-series line chart titled 'The Rise and Fall of the Sheep' showing population of New Zealand livestock from 1935 to 2024. Sheep dominated throughout, peaking near 70 million in the early 1980s before declining steadily to about 24 million by 2024. Cattle remained relatively stable between 8-10 million from 1971 onward. Poultry data begins in 2002 at around 22 million and stays fairly consistent near 25 million. Pigs remained the smallest population, fluctuating between 250,000 and 550,000 throughout the recorded period.
---

This week's dataset is on New Zealand agriculture, complete with this quote from a [May 2025 article](https://www.rnz.co.nz/news/country/560252/gap-between-people-and-sheep-rapidly-closing):

> The gap between people and sheep in New Zealand is rapidly closing. There's now about 4.5 sheep to every person in New Zealand compared to a peak of 22 sheep per person in the 1980s, that's according to figures released by Stats NZ this week.

I went with the obvious one and put the total population of sheep, cattle, pigs, and poultry on a chart. (Most of my investment this week was developing this [time-series line chart](https://uncharted.seanlunsford.com/chart-types/#time-series-charts) for [Uncharted](https://uncharted.seanlunsford.com/)â€”plus [integrating](https://uncharted.seanlunsford.com/features/#icon-support) [Font Awesome](https://fontawesome.com/) for the icons.)

The thing that almost got me was that they had "Total Cattle" up through 1999, and then I was only seeing "Total Beef Cattle" and "Total Dairy Cattle (including Bobby Calves)" broken out. I initially assumed this was when they'd introduced this breakdown, but eventually I realized they'd had those categories all along; they just also had the total for the first few decades of cattle data. So I was doubling the count until I caught that.

{% chart 'nz-livestock' %}

## The Query

Most of the convoluted transformation here was doing some replacements to turn the records I wanted into simple sheep/cattle/pigs/poultry. I also had to specifically get the beef and dairy cattle and sum them, to exclude the "Total Cattle" records that were throwing off my data at first.

```sql
with

animal_types as (
     select year_ended_june as year,
            lower(trim(regexp_replace(measure, '^Total|\(including Bobby Calves\)$', '', 'g'))) as animal,
            value

       from "https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2026/2026-02-17/dataset.csv"
      where animal in ('sheep', 'beef cattle', 'dairy cattle', 'pigs', 'poultry')
),

pivot_animals as (
      pivot animal_types on animal
      using sum(value)
   order by year
)

   select * exclude ("beef cattle", "dairy cattle"),
          "beef cattle" + "dairy cattle" as cattle
     from pivot_animals
```
