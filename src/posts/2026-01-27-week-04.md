---
title: Brazilian Companies
date: 2026-01-27
published: 2026-01-31T18:04:00+05:30
week: 4
charts:
  companies:
    type: sankey
    title: Brazilian Breakdown
    subtitle: Number of companies by size and legal category
    file: 2026-01-27/companies.csv
    value:
      format:
        thousands: true
    alt: "Sankey diagram showing the breakdown of Brazilian companies by size and legal category. Brazil's roughly 141,000 companies split into three size groups: Micro enterprise (66,000), Other (42,500), and Small enterprise (32,600). From each size group, flows branch into legal categories. LLCs dominate across all sizes, accounting for about 120,000 companies total. Sole Proprietorships are the next largest category at around 15,000, concentrated heavily in Micro enterprises. Partnerships and Privately Held Corporations appear mainly in the Other size category, with smaller numbers elsewhere. Cooperatives, Publicly Traded Corporations, and State-Owned Enterprises make up a very small share."
    image:
      width: 1000
      height: 560
  capital:
    type: sankey
    title: Brazilian Breakdown (Capital)
    subtitle: Combined capital (BRL) of companies by size and legal category
    file: 2026-01-27/capital.csv
    value:
      format:
        compact: true
        currency:
          symbol: 'R$ '
    alt: "Sankey diagram showing Brazilian company capital (BRL) by size and legal category. Unlike the company count chart, capital is concentrated differently: Small enterprises hold R$27.3 trillion, Other size category holds R$21.3 trillion, while Micro enterprises have only R$1.4 trillion. LLCs dominate capital across all sizes, holding nearly R$49 trillion total. Privately Held Corporations in the Other category hold R$488 billion, and Publicly Traded Corporations hold R$164 billion. Sole Proprietorships, despite being numerous in micro enterprises, hold relatively little capital (R$173 billion in micro, R$6 billion in other)."
    image:
      width: 1000
      height: 560
---

This dataset lists companies in Brazil with their legal nature (sole proprietorship, publicly traded corporation etc.), size (small enterprise, micro enterprise, or other), and qualifications of the owner, as well as their capital stock.

I thought looking at the breakdown of size and type was interesting, as was a comparison by number of companies vs. capital making up each grouping.

Listing all the legal entities in the data overwhelmed the visual a bit, so I did some categorizing myself—all limited liability corporations, all types of partnerships, all co-ops, and then putting a bunch in an "Other" bucket.

{% chart 'companies' %}
{% chart 'capital' %}

## Queries

This was my staging table of sorts, where I pulled in the CSV, formatted `company_size`, and added a column categorizing `legal_nature`.

```sql
create or replace table companies as

 select * replace (replace(upper(company_size[1])||company_size[2:], '-', ' ') as company_size),
                   -- Turn `small-enterprise` into `Small enterprise`
        -- Group legal entities into categories
        case when legal_nature in (
                    -- pass-through
                    'Sole Proprietorship',
                    'Privately Held Corporation',
                    'Publicly Traded Corporation',
                    'State-Owned Enterprise') then legal_nature
             -- group types containing key phrases
             when legal_nature like '%Limited Liability%' then 'LLC'
             when legal_nature like '%Partnership%' then 'Partnership'
             when legal_nature like '%Cooperative%' then 'Cooperative'
             else 'Other Type'
              end as legal_category
   from 'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2026/2026-01-27/companies.csv'
```

To get the multi-level Sankey diagram, I needed to `union all` two sets of data—one just grouping by the company size with 'Brazil' as the source, and one grouping by size and legal category to count "flow" between them.

```sql
create or replace view companies_sankey as

   select 'Brazil' as source,
          company_size as target,
          count(*) as companies
     from companies
 group by all

union all

   select company_size,
          legal_category,
          count(*) as companies
     from companies
 group by all

 order by 3 desc, company_size, legal_category
```

I ordered by the third column because this translated between queries without having to change what that column was in the `order by` clause:

```sql
create or replace view capital_sankey as

   select 'Brazilian capital' as source,
          company_size as target,
          sum(capital_stock) as capital_stock
     from companies
 group by all

union all

   select company_size,
          legal_category,
          sum(capital_stock) as capital_stock
     from companies
 group by all

 order by 3 desc, company_size, legal_category
```


