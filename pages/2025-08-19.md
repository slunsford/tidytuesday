---
title: Scottish Munros
date: 2025-08-19
---

So here goes the first week I'm tackling TidyTuesday. The dataset this week is on Scottish geography. To quote the readme:

> A Munro is a Scottish mountain with an elevation of over 3,000 feet, whereas a Munro Top is a subsidiary summit of a Munro that also exceeds 3,000 feet in height but is not considered a distinct mountain in its own right. The most famous Munro is Ben Nevis.
>
> In 1891, Sir Hugh Munro produced the first list of these hills. However, unlike other classification schemes in Scotland which require a peak to have a prominence of at least 500 feet for inclusion, the Munros lack a rigid set of criteria for inclusion. And so, re-surveying can lead to changes in which peaks are included on the list.


```sql count_all
select count(*) from tidytuesday.scottish_munros
```

```sql count_current_munros
select count(*) as current_munros,
       count_if("1891" = 'Munro') as original_munros
  from tidytuesday.scottish_munros
 where "2021" = 'Munro'
```

Of the <Value data={count_all}/> peaks in the data, <Value data={count_current_munros} column=current_munros/> are currently classified as Munros, and of those, <Value data={count_current_munros} column=original_munros/> were counted on the original 1891 list.

```sql original_vs_current_counts
select "1891" as original,
       "2021" as current,
       count(*) as munros_count
  from tidytuesday.scottish_munros
 group by all
```

<!--
<SankeyDiagram
    data = {original_vs_current_counts}
    sourceCol = original
    targetCol = current
    valueCol = munros_count
/> -->

We can unpivot the data to get a better look at changes over time.

```sql classifications_by_year
with unpivoted as (
    unpivot tidytuesday.scottish_munros
         on columns('[0-9]{4}')
       into name year
            value classification
)

 select name,
        year,
        lag(classification, 1) over (partition by name order by year) as previous_classification,
        classification,
        classification != previous_classification as is_reclassified,
        case when previous_classification is null then 'New'
             when not is_reclassified then 'No Change'
             when previous_classification = 'Munro' then 'Downgrade'
             when classification like 'Munro%'  then 'Upgrade'
             when classification is null        then 'Downgrade'
              end as change_type,
   from unpivoted
```

```sql dimensions
select classification,
       change_type
  from ${classifications_by_year}
```

<DimensionGrid data={dimensions} name="selected_dimensions"/>

```sql annual_data
select year,
       count_if(classification = 'Munro') as munros,
       count_if(classification = 'Munro Top') as munro_tops,
       count_if(change_type = 'Upgrade') as upgrades,
       -count_if(change_type = 'Downgrade') as downgrades
  from ${classifications_by_year}
 where ${inputs.selected_dimensions}
 group by all
 order by year
```

<Chart data={annual_data} chartAreaHeight=360>
    <Line y=munros/>
    <Line y=munro_tops/>
    <Bar y=upgrades/>
    <Bar y=downgrades/>
</Chart>


