---
title: Scottish Munros
date: 2025-08-19
week: 33
---

<Note>
  Week 33 â€¢ 19 August 2025
</Note>

So here goes the first week I'm tackling TidyTuesday. The dataset this week is on Scottish geography. To quote the [readme](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-08-19/readme.md):

> A Munro is a Scottish mountain with an elevation of over 3,000 feet, whereas a Munro Top is a subsidiary summit of a Munro that also exceeds 3,000 feet in height but is not considered a distinct mountain in its own right. The most famous Munro is Ben Nevis.
>
> In 1891, Sir Hugh Munro produced the first list of these hills. However, unlike other classification schemes in Scotland which require a peak to have a prominence of at least 500 feet for inclusion, the Munros lack a rigid set of criteria for inclusion. And so, re-surveying can lead to changes in which peaks are included on the list.

```sql count_all
select count(*) from tidytuesday.scottish_munros
```

```sql count_current_munros
select count(*) as current_munros,
       count_if("1891" = 'Munro') as original_munros
  from tidytuesday.scottish_munros
 where "2021" = 'Munro'
```

Of the <Value data={count_all}/> peaks in the data, <Value data={count_current_munros} column=current_munros/> are currently classified as Munros; of those, <Value data={count_current_munros} column=original_munros/> were counted on the original 1891 list.

```sql reclassifications
with unpivoted as (
    unpivot tidytuesday.scottish_munros
         on columns('[0-9]{4}')
       into name year
            value classification
),

compared as (
   select dobih_number as id,
          name as name,
          year,
          lag(classification, 1) over (partition by id order by year) as previous_classification,
          classification as new_classification,
          classification != previous_classification as is_reclassified,
          case when previous_classification is null then 'New'
               when not is_reclassified then 'No Change'
               when previous_classification = 'Munro' then 'Downgrade'
               when new_classification like 'Munro%'  then 'Upgrade'
               when new_classification = 'NA'         then 'Downgrade'
                end as change_type,
     from unpivoted
)

from compared where is_reclassified
```

```sql dimensions
select name,
       previous_classification,
       new_classification
  from ${reclassifications}
```

<DimensionGrid data={dimensions} name="selected_dimensions"/>

```sql count_by_year
select year,
       change_type,
       count(*) as reclassifications
  from ${reclassifications}
 where ${inputs.selected_dimensions}
 group by all
 order by year
```

<BarChart
    data={count_by_year}
    x=year
    y=reclassifications
    series=change_type
    title='Number of Munros Reclassified by Year'
    sort=false
    chartAreaHeight=300
/>
